/**
 * Фильтр "что считать специализацией ветклиники".
 * Наша цель: убрать из списков и отчётов служебные/финансовые/админские категории
 * (например: "Уборщица", "Инженер", "Генеральный директор", "Оплата стационара" и т.д.)
 *
 * Диагностику (МРТ/КТ/УЗИ) оставляем.
 */

function norm(s: string) {
  return (s ?? "")
    .toString()
    .trim()
    .replace(/\s+/g, " ")
    .toLowerCase();
}

const NOISE_PATTERNS: RegExp[] = [
  // Финансы/оплаты
  /\bоплат/iu,
  /\bплат[её]ж/iu,
  /\bсч[её]т/iu,
  /\bкасса/iu,
  /\bвозврат/iu,
  /\bскидк/iu,
  /\bдепозит/iu,
  /\bаванс/iu,
  /\bначислен/iu,
  /\bштраф/iu,
  /\bпен[яи]/iu,

  // Админка/персонал (не медицинские направления)
  /\bуборщ/iu,
  /\bинженер/iu,
  /\bгенеральн\b.*\bдиректор/iu,
  /\bдиректор/iu,
  /\bбухгалтер/iu,
  /\bкассир/iu,
  /\bадминистратор/iu,
  /\bменеджер/iu,
  /\bмаркет/iu,
  /\bsmm\b/iu,
  /\bhr\b/iu,
  /\bкурьер/iu,
  /\bводитель/iu,
  /\bохран/iu,
  /\bсекретар/iu,
  /\bюрист/iu,

  // Внутренние расходы
  /\bзарплат/iu,
  /\bоклад/iu,
  /\bпреми/iu,
  /\bналог/iu,
  /\bаренд/iu,
  /\bкоммун/iu,
  /\bхоз\b/iu,
  /\bканцел/iu,
  /\bинтернет/iu,
  /\bсвяз/iu,
  /\bхостинг/iu,

  // Тестовые/служебные
  /\bтест/iu,
  /\bdemo\b/iu,
  /\bдемо\b/iu,
];

export function isVetSpecialization(name: string | null | undefined): boolean {
  const n = norm(name ?? "");
  if (!n) return false;
  // совсем короткие мусорные значения
  if (n.length <= 1) return false;

  // Если это "оплата ..." — точно не специализация
  for (const re of NOISE_PATTERNS) {
    if (re.test(n)) return false;
  }

  return true;
}
